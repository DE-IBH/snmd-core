define(["snmd-core/js/SVGWidget","js-logger","jquery","jquery.svg","jquery.svggraph","css!snmd-core/lib/svg-1.5.0/jquery.svg.css"],function(t,e,n){"use strict";var r=null,s=function(){if(null!==r)throw new Error("Cannot instantiate more than one instance, use getInstance()!")};return s.getInstance=function(){return null===r&&(r=new s),r},s.prototype.srParseSVG=function(r,s){if(s)return e.error("[SVG] Failed loading SVG: "+s),void r.text(10,20,s,{fill:"red"});r.root().setAttribute("width","100%"),r.root().setAttribute("height","100%");var o=function(){this.style.fill=""};n('[class^="snmd-fill-"],[class*=" snmd-fill-"]',r.root()).each(o).children().each(o);var i=function(){this.style.stroke=""};n('[class^="snmd-stroke-"],[class*=" snmd-stroke-"]',r.root()).each(i).children().each(i),n('[id^="snmd_"]',r.root()).each(function(){var s;try{s=JSON.parse(n(this).find("desc").text())}catch(t){e.error("JSON error in widget instance #"+this.id+": "+t.message)}s&&t.srCreateWidget(r,this,s)})},s.prototype.srLoadSVG=function(t,r){e.debug("[SVG] Loading #"+t+": "+r),n("#"+t).svg({loadURL:r+"?nonce="+Math.random(),"max-width":"100%","max-height":"100%",onLoad:this.srParseSVG})},s.prototype.srRelToAbsPos=function(t,e){var n=t.getBoundingClientRect(),r=e.getBoundingClientRect(),s=e.getScreenCTM();return{x:s.a*r.left+s.c*r.top+s.e+n.left,y:s.b*r.left+s.d*r.top+s.f+n.top}},s.getInstance()});