define(["snmd-core/js/GUI","svgpathdata","jquery"],function(t,s,a){"use strict";var i=function(t,i,h,o){this.opts=h,this.cls=h.cls.base,this.root=t,this.opts.dim={id:i.id,x:i.x.baseVal.value,y:i.y.baseVal.value+i.height.baseVal.value,width:i.width.baseVal.value,height:i.height.baseVal.value,cX:i.x.baseVal.value+i.width.baseVal.value/2,cY:i.y.baseVal.value+i.height.baseVal.value/2,rX:i.width.baseVal.value/2,rY:i.height.baseVal.value/2},void 0===this.opts.rot_max?this.opts.dim.rot_max=359.999:this.opts.dim.rot_max=parseFloat(this.opts.rot_max),void 0===this.opts.rot_offset?this.opts.dim.rot_offset=180:this.opts.dim.rot_offset=parseFloat(this.opts.rot_offset),t.remove(i),this.pathdata=new s(this.arc(this.opts.dim.rot_max).join(" ")),this.last_stroke="",this.last_val=-1;var e=this.root.path(this.pathdata.encode(),{class:this.cls.map(function(t){return t+"-BG"}).join(" ")});void 0!==o&&((e=a(e)).addClass("snmd-bcl-Widget"),e.qtip(o))};return i.prototype.pol2Cart=function(t){var s=(t+this.opts.dim.rot_offset)*Math.PI/180;return{x:this.opts.dim.cX+this.opts.dim.rX*Math.cos(s),y:this.opts.dim.cY+this.opts.dim.rY*Math.sin(s)}},i.prototype.arc=function(t){var s,a=this.pol2Cart(0),i=this.pol2Cart(t);return s=t>180?1:0,["M",a.x,a.y,"A",this.opts.dim.rX,this.opts.dim.rY,0,s,1,i.x,i.y]},i.prototype.update=function(s,a,i){if(s!==this.last_val||i!==this.last_state){s>a&&(s=a);var h=this.opts.dim.rot_max/a*s,o=this.pol2Cart(h);this.pathdata.commands[1].lArcFlag=h>180?1:0,this.pathdata.commands[1].x=o.x,this.pathdata.commands[1].y=o.y,i!==this.last_state&&(this.opts.cls.state.forEach(function(t){var s=this.cls.indexOf(t+this.last_state);s>-1&&this.cls.splice(s,1)},this),this.opts.cls.state.forEach(function(t){this.cls.push(t+i)},this)),void 0!==this.svg&&this.root.remove(this.svg),this.svg=this.root.path(this.pathdata.encode(),{id:this.opts.dim.id,class:this.cls.join(" ")}),this.last_val=s,i!==this.last_state&&(this.last_state=i,t.srStateChanged(this.root._svg.parentElement.id,this.opts.dim.id,i))}},i});