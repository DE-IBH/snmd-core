define(["snmd-core/js/GUI","snmd-core/js/MQTT","snmd-core/js/SVGWidget","snmd-core/js/Sound","sprintf","jquery","js-logger","JSON.minify"],function(t,i,n,e,o,s,r,a){"use strict";var d=null,f=s("#snmd-title-label"),c=function(){if(null!==d)throw new Error("Cannot instantiate more than one instance, use getInstance()!");this.version="0.3",this.si_prefs=["T","G","M","k",""],this.si_facts=[Math.pow(10,12),Math.pow(10,9),Math.pow(10,6),Math.pow(10,3),1],this.genid=0,this.loadDiv=s("#snmd-load-div")};return c.getInstance=function(){return null===d&&(d=new c),d},c.prototype.srVersion=function(){return this.version},c.prototype.srURLParam=function(t,i){var n=new RegExp("[?&]"+t+"=([^&#/]*)([&#/]|$)").exec(window.location.href);return n&&n[1]?decodeURIComponent(n[1]):i},c.prototype.srConfigLoaded=function(n){this.config=n,f.text(this.config.view.title?this.config.view.title:window.location.host),"undefined"==typeof this.config.mqttws_host&&(this.config.mqttws_host=window.location.hostname),"undefined"==typeof this.config.mqttws_port&&(this.config.mqttws_port=9001),i.srInit(this.config.mqttws_host,this.config.mqttws_port);var e=s("#snmd-title div.snmd-dd-list");if(s.isArray(this.config.vlinks)&&this.config.vlinks.length>0){f.append(s("<sup></sup>").text(this.config.vlinks.length));var o=0;this.config.vlinks.forEach(function(t){var i=t.title||t.name;o=o>i.length?o:i.length,s("<a></a>").attr({href:"?config="+t.name}).text(i).appendTo(e)}),e.css("min-width",o+2+"em")}else e.remove();r.debug('[Core] Loading view "'+this.config.view.json+'"'),s.ajax({global:!1,url:this.config.view.json+"?nonce="+Math.random(),dataType:"json",dataFilter:function(t){return a.minify(t)},success:function(i){t.srInit(i)}.bind(this),error:function(t,i,n){r.error("[Core] Failed to load view list: "+i+" - "+n)}.bind(this)})},c.prototype.srInitLoad=function(t,i){r.debug("[Core] Loading view config: "+t),s.ajax({global:!1,url:t+"?nonce="+Math.random(),dataType:"json",dataFilter:function(t){return a.minify(t)},success:this.srConfigLoaded.bind(this),error:i})},c.prototype.snmdInit=function(t){if(r.info("[Core] snmd v"+this.version+" - Scotty Network Management Dashboard"),"object"==typeof t.snmd_widgets){var i,o=function(t){r.info("[Core]  "+this.prefix+" => "+this["package"]+" v"+t.getVersion()),t.init(this.prefix,this["package"])};for(i in t.snmd_widgets){var s=t.snmd_widgets[i],a={paths:{}};a.paths[s["package"]]=s["package"]+(t.snmd_devel===!0?"":"/dist"),require.config(a),require([s["package"]+"/js/Boot"],o.bind(s)),n.snmdRegisterPrefix(s.prefix,s["package"])}}e.snmdLoadSet("default"),this.srInitLoad("configs/"+this.srURLParam("config","default")+".json",function(){this.srInitLoad("configs/default.json",function(t,i,n){r.error("[Core] Failed to load configuration: "+i+" - "+n)})}.bind(this))},c.prototype.snmdFinishLoading=function(){if("undefined"!=typeof this.loadDiv){var t=this.loadDiv;this.loadDiv=void 0,t.fadeOut(3e3),window.setTimeout(function(){t.remove()},3e3)}},c.prototype.srSiFormatNum=function(t,i,n,e){if("undefined"==typeof t)return n;if(isNaN(t))return n;var s=0;0>t&&(t=-1*t,s=1);var r,a=4;for(r=0;r<this.si_facts.length;r++)if(t>=.99*this.si_facts[r]){a=r;break}return t/=this.si_facts[a],("undefined"==typeof e||isNaN(e))&&(e=10>t?1:0),s&&(t=-1*t),o.sprintf("%."+e+"f%s%s",t,this.si_prefs[a],i)},c.prototype.srNagStateColor=function(t){return"undefined"==typeof t?"Grey":0===t?"LimeGreen":1===t?"Gold":2===t?"Crimson":"Orange"},c.prototype.srGenID=function(t){return this.genid+=1,"snmd-genid-"+t+"-"+this.genid},c.getInstance()});
//# sourceMappingURL=dist/js/Core.map