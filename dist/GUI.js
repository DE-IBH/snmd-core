define(["snmd-core/Core","snmd-core/HTML","snmd-core/SVG","require","jquery","sprintf","css!../../snmd-core/css/gui.css"],function(e,t,s,i,n,r){"use strict";var a=null,c=function(){if(null!==a)throw new Error("Cannot instantiate more than one instance, use getInstance()!");this.idCounter=0,this.TO_SCREEN=6e5,this.TO_SWITCH=3e4,this.screenState=0,this.viewStates={},this.viewFinalStates={},this.currentStep=0};return c.getInstance=function(){return null===a&&(a=new c),a},c.prototype.srScreenTimeOut=function(){0===this.screenState&&(this.screenState+=1,n(document.body).addClass("on-screensaver"));var e=this;n(".srViews").each(function(){var t,s=n(this).children(".srViewsNav").find("a"),i=0;for(t=0;t<s.length;t++)s[t].hash===e.currentView&&(i=t);i+=1,i>=s.length&&(i=0),s[i].click()}),this.screenTimeOut=window.setTimeout(this.srScreenTimeOut,this.TO_SWITCH)}.bind(this),c.prototype.srStateChanged=function(e,t,s){if(this.viewStates[e][t]=s,this.viewFinalStates[e]<s)this.viewFinalStates[e]=s,n("#switch-"+e).css("color",i("snmd-core/Core").srNagStateColor(this.viewFinalStates[e]));else if(this.viewFinalStates[e]>s){var r=s,a=this;Object.keys(this.viewStates[e]).forEach(function(t){a.viewStates[e][t]>r&&(r=a.viewStates[e][t])}),this.viewFinalStates[e]=r,n("#switch-"+e).css("color",i("snmd-core/Core").srNagStateColor(this.viewFinalStates[e]))}},c.prototype.srInit=function(e){var i=this;n(".srViews").each(function(){var r={},a=n(this).children(".srViewsNav");Object.keys(e).forEach(function(t){r[t]="srView-"+(this.idCounter+=1).toString(16),this.viewStates[r[t]]={},this.viewFinalStates[r[t]]=-1,a.append('<li><a id="switch-'+r[t]+'" href="#'+r[t]+'"><span>'+e[t].title+"</span></a></li>")},i);var c=n("#snmd-views"),o=360/Object.keys(e).length,h=0,d=Object.keys(e).length>1?953/Math.tan(Math.PI/Object.keys(e).length):0;Object.keys(e).forEach(function(i){switch(c.append('<div class="svgview" id="'+r[i]+'"></div>'),n(document.body).hasClass("enable-3d")&&n("#"+r[i]).css("transform","rotateY("+o*h+"deg) translateZ("+d+"px)"),e[i].render){case"html":t.srLoadHTML(r[i],e[i].url,e[i].reload);break;default:s.srLoadSVG(r[i],e[i].url)}h+=1}),n("#snmd-views").css("transform-origin","100% 50% 50%");var l=function(){var e=1;n(document.body).hasClass("enable-3d")&&n("#snmd-views").css("transform","scale("+e+") translateZ(-"+d+"px) rotateY("+-1*o*this.currenStep+"deg)")}.bind(this);if(a.find("a").click(function(){return console.debug("Viewing "+this.hash),i.currentView=this.hash,c.children().removeClass("current").filter(this.hash).removeClass("next").removeClass("prev").addClass("current"),n(i.currentView).prevAll().removeClass("next").addClass("prev"),n(i.currentView).nextAll().removeClass("prev").addClass("next"),a.find("a").removeClass("selected").filter(this).addClass("selected"),i.currenStep=n(i.currentView).prevAll().length,l(),!1}).filter(":first").click(),"undefined"!==window.location.hash){var u=parseInt(window.location.hash.replace(/^#srView-/,""),10)-1;a.find("a:eq("+u+")").click()}n("#snmd-ctrl").find("a").click(function(){return console.debug("Control: "+this.hash),!1}).filter(":first").click()},this);var a=n("div#snmd_clock");a&&window.setInterval(function(){var e=new Date,t=-e.getTimezoneOffset(),s=t>=0?"+":"-";t=Math.abs(t);var i=r.sprintf("%d-%02d-%02dT%02d:%02d:%02d%s%02d%02d",e.getFullYear(),e.getMonth()+1,e.getDay(),e.getHours(),e.getMinutes(),e.getSeconds(),s,t/60,t%60);a.text(i)},1e3),this.screenTimeOut=window.setTimeout(this.srScreenTimeOut,this.TO_SCREEN),n(document).mousemove(function(){this.screenState=0,"undefined"!=typeof this.screenTimeOut&&(window.clearTimeout(this.screenTimeOut),this.screenTimeOut=window.setTimeout(this.srScreenTimeOut,this.TO_SCREEN),n(document.body).removeClass("on-screensaver"))}.bind(this)),n(document).keypress(function(e){if(this.screenState=0,"undefined"!=typeof this.screenTimeOut&&(window.clearTimeout(this.screenTimeOut),this.screenTimeOut=window.setTimeout(this.srScreenTimeOut,this.TO_SCREEN)),e.which>47&&e.which<58){var t=48===e.which?"10":String.fromCharCode(e.which);n('a[href="#srView-'+t+'"]').click()}}.bind(this))},c.getInstance()});
//# sourceMappingURL=dist/GUI.map